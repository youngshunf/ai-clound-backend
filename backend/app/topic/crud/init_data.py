from sqlalchemy import select
from sqlalchemy.ext.asyncio import AsyncSession

from backend.app.topic.model.industry import Industry

# 初始化行业数据
INITIAL_INDUSTRIES = [
    {
        "name": "科技数码",
        "keywords": ["科技", "数码", "黑科技", "极客"],
        "children": [
            {"name": "人工智能", "keywords": ["AI", "ChatGPT", "Midjourney", "Stable Diffusion", "LLM", "AIGC", "Prompt", "Sora"]},
            {"name": "数码评测", "keywords": ["手机", "电脑", "相机", "耳机", "智能穿戴", "显卡", "DIY装机", "平板"]},
            {"name": "软件应用", "keywords": ["App推荐", "效率工具", "Notion", "SaaS", "Mac", "Windows", "Chrome插件"]},
            {"name": "极客硬核", "keywords": ["树莓派", "智能家居", "NAS", "网络安全", "编程开发", "GitHub", "Linux"]},
            {"name": "前沿科技", "keywords": ["元宇宙", "Web3", "区块链", "AR/VR", "自动驾驶", "量子计算", "航天"]},
        ]
    },
    {
        "name": "校园青春",
        "keywords": ["校园", "青春", "大学", "学生"],
        "children": [
            {"name": "大学生活", "keywords": ["宿舍", "选课", "社团", "食堂", "校园Vlog", "大学生", "期末周"]},
            {"name": "科研学术", "keywords": ["论文", "实验", "文献", "读博", "SCI", "毕设", "学术会议", "实验室日常"]},
            {"name": "青春感悟", "keywords": ["情感", "随笔", "怀旧", "毕业季", "成长", "暗恋", "同学录"]},
            {"name": "求职实习", "keywords": ["校招", "实习", "简历", "面试", "秋招", "春招", "管培生"]},
        ]
    },
    {
        "name": "创业自媒体",
        "keywords": ["创业", "自媒体", "副业", "IP"],
        "children": [
            {"name": "自媒体运营", "keywords": ["涨粉", "变现", "剪辑技巧", "脚本", "直播带货", "短视频", "小红书运营"]},
            {"name": "创业实战", "keywords": ["开店", "摆摊", "商业计划书", "创业故事", "合伙人", "融资", "地推"]},
            {"name": "个人IP", "keywords": ["个人品牌", "垂直领域", "人设", "私域流量", "知识付费"]},
            {"name": "副业搞钱", "keywords": ["兼职", "技能变现", "闲鱼", "配音", "接单", "信息差"]},
        ]
    },
    {
        "name": "美妆护肤",
        "keywords": ["美妆", "化妆", "护肤", "变美"],
        "children": [
            {"name": "彩妆", "keywords": ["眼妆", "口红试色", "妆容教程", "仿妆", "遮瑕", "底妆", "国货彩妆"]},
            {"name": "护肤", "keywords": ["成分党", "早C晚A", "敏感肌", "祛痘", "抗老", "防晒", "面膜", "精华"]},
            {"name": "医美", "keywords": ["轻医美", "热玛吉", "光子嫩肤", "整形", "术后护理", "水光针"]},
            {"name": "美发", "keywords": ["发型设计", "染发", "烫发", "护发", "假发", "编发教程", "高颅顶"]},
            {"name": "香氛", "keywords": ["大牌香水", "小众沙龙香", "香薰蜡烛", "居家香氛", "木质调"]},
        ]
    },
    {
        "name": "美食饮品",
        "keywords": ["美食", "吃货", "烹饪", "美味"],
        "children": [
            {"name": "家常菜谱", "keywords": ["下饭菜", "快手菜", "便当", "早餐", "减脂餐", "空气炸锅", "懒人食谱"]},
            {"name": "甜点烘焙", "keywords": ["蛋糕", "面包", "饼干", "下午茶", "烤箱食谱", "甜品"]},
            {"name": "探店美食", "keywords": ["必吃榜", "街头小吃", "苍蝇馆子", "自助餐", "咖啡店", "奶茶评测", "网红店"]},
            {"name": "酒水饮品", "keywords": ["咖啡", "茶道", "鸡尾酒", "精酿啤酒", "威士忌", "快乐水", "果汁"]},
            {"name": "生鲜食材", "keywords": ["海鲜", "牛排", "水果", "预制菜", "调料", "时令蔬菜"]},
        ]
    },
    {
        "name": "时尚穿搭",
        "keywords": ["时尚", "穿搭", "潮流", "搭配"],
        "children": [
            {"name": "女装穿搭", "keywords": ["OOTD", "每日穿搭", "显瘦", "法式", "韩系", "美式复古", "梨形身材"]},
            {"name": "男装穿搭", "keywords": ["潮流工装", "商务休闲", "球鞋搭配", "日系Cityboy", "CleanFit"]},
            {"name": "箱包配饰", "keywords": ["大牌包", "帆布包", "珠宝首饰", "墨镜", "帽子", "丝巾"]},
            {"name": "鞋靴", "keywords": ["球鞋", "高跟鞋", "马丁靴", "乐福鞋", "拖鞋", "运动鞋"]},
        ]
    },
    {
        "name": "家居生活",
        "keywords": ["生活", "家居", "日常", "Vlog"],
        "children": [
            {"name": "装修设计", "keywords": ["全屋定制", "软装", "极简风", "奶油风", "智能家居", "旧房改造"]},
            {"name": "家居好物", "keywords": ["收纳整理", "清洁神器", "提升幸福感", "厨房好物", "宜家好物"]},
            {"name": "萌宠", "keywords": ["喵星人", "汪星人", "宠物零食", "宠物医疗", "异宠", "哈士奇"]},
            {"name": "生活技巧", "keywords": ["生活妙招", "省钱攻略", "避坑指南", "DIY手工", "断舍离"]},
        ]
    },
    {
        "name": "教育职场",
        "keywords": ["教育", "学习", "职场", "成长"],
        "children": [
            {"name": "语言学习", "keywords": ["英语口语", "雅思托福", "日语", "韩语", "小语种", "背单词"]},
            {"name": "考试考证", "keywords": ["考研", "公务员", "教资", "CPA", "法考", "考编", "高考"]},
            {"name": "职场提升", "keywords": ["面试技巧", "简历优化", "职场沟通", "升职加薪", "办公软件", "Excel"]},
            {"name": "留学移民", "keywords": ["留学申请", "签证", "海外生活", "移民政策", "留学生"]},
            {"name": "读书笔记", "keywords": ["书单推荐", "深度阅读", "个人成长", "思维导图", "读后感"]},
        ]
    },
    {
        "name": "金融理财",
        "keywords": ["财经", "金融", "钱", "搞钱"],
        "children": [
            {"name": "投资理财", "keywords": ["基金", "股票", "定投", "资产配置", "黄金", "美股"]},
            {"name": "存钱规划", "keywords": ["记账", "攒钱挑战", "极简生活", "FIRE运动", "理财观念"]},
            {"name": "商业思维", "keywords": ["商业模式", "品牌营销", "流量变现", "经济学原理", "财报分析"]},
            {"name": "房产", "keywords": ["刚需买房", "学区房", "房产投资", "装修避坑", "楼市分析"]},
        ]
    },
    {
        "name": "旅行出行",
        "keywords": ["旅行", "旅游", "攻略", "打卡"],
        "children": [
            {"name": "国内游", "keywords": ["川西", "新疆", "云南", "三亚", "小众景点", "自驾游", "特种兵旅游"]},
            {"name": "国外游", "keywords": ["东南亚", "欧洲", "日本", "签证攻略", "穷游", "免签"]},
            {"name": "户外露营", "keywords": ["露营装备", "徒步", "登山", "飞盘", "滑雪", "潜水", "骑行"]},
            {"name": "酒店民宿", "keywords": ["民宿推荐", "五星酒店", "亲子酒店", "青年旅舍", "酒店试睡"]},
        ]
    },
    {
        "name": "运动健康",
        "keywords": ["运动", "健身", "健康", "体育"],
        "children": [
            {"name": "健身塑形", "keywords": ["增肌", "减脂", "帕梅拉", "刘畊宏", "瑜伽", "普拉提", "马甲线"]},
            {"name": "健康养生", "keywords": ["中医养生", "泡脚", "睡眠", "营养补充剂", "心理健康", "抗糖"]},
            {"name": "体育赛事", "keywords": ["NBA", "欧冠", "英超", "世界杯", "奥运会", "F1", "电竞比赛"]},
            {"name": "运动装备", "keywords": ["球鞋", "跑鞋", "运动手环", "瑜伽服", "滑雪板"]},
        ]
    },
    {
        "name": "汽车出行",
        "keywords": ["汽车", "车", "出行", "新能源"],
        "children": [
            {"name": "新车资讯", "keywords": ["上市发布", "谍照", "价格预测", "车展", "概念车"]},
            {"name": "试驾评测", "keywords": ["驾驶体验", "续航测试", "空间对比", "碰撞测试", "百公里加速"]},
            {"name": "用车养车", "keywords": ["保养", "改装", "车险", "维修", "避坑", "洗车"]},
            {"name": "新能源", "keywords": ["特斯拉", "比亚迪", "蔚小理", "充电桩", "自动驾驶", "电池技术", "混动"]},
        ]
    },
    {
        "name": "母婴育儿",
        "keywords": ["母婴", "育儿", "宝宝", "亲子"],
        "children": [
            {"name": "备孕怀孕", "keywords": ["孕期营养", "产检", "胎教", "待产包", "月子餐"]},
            {"name": "育儿经验", "keywords": ["辅食添加", "睡眠引导", "绘本推荐", "玩具", "疫苗", "早教"]},
            {"name": "亲子教育", "keywords": ["英语启蒙", "逻辑思维", "亲子游戏", "幼升小", "家庭教育"]},
        ]
    },
    {
        "name": "养老生活",
        "keywords": ["养老", "老年", "银发族", "退休"],
        "children": [
            {"name": "健康养老", "keywords": ["老年养生", "慢性病管理", "老年运动", "太极", "广场舞"]},
            {"name": "退休规划", "keywords": ["养老金", "旅居养老", "老年大学", "退休生活", "隔代育儿"]},
            {"name": "适老产品", "keywords": ["助听器", "按摩椅", "智能拐杖", "老人手机", "防摔装备"]},
            {"name": "老年娱乐", "keywords": ["书法绘画", "花鸟鱼虫", "戏曲", "棋牌", "老年旅游"]},
        ]
    },
    {
        "name": "娱乐游戏",
        "keywords": ["娱乐", "游戏", "动漫", "影视"],
        "children": [
            {"name": "影视", "keywords": ["电影推荐", "剧评", "综艺", "纪录片", "追剧", "美剧", "韩剧", "经典台词"]},
            {"name": "动漫二次元", "keywords": ["新番", "国漫", "日漫", "Cosplay", "手办", "声优", "漫展", "虚拟主播"]},
            {"name": "明星八卦", "keywords": ["娱乐圈", "演唱会", "粉丝见面会", "吃瓜", "路透"]},
            {"name": "网络游戏", "keywords": ["英雄联盟", "王者荣耀", "原神", "吃鸡", "蛋仔派对", "电竞"]},
            {"name": "主机单机", "keywords": ["Steam", "Switch", "PS5", "塞尔达", "黑神话悟空", "老头环"]},
        ]
    },
    {
        "name": "摄影艺术",
        "keywords": ["摄影", "拍照", "艺术", "设计"],
        "children": [
            {"name": "摄影技巧", "keywords": ["构图", "调色", "人像", "风光", "街拍", "手机摄影", "胶片"]},
            {"name": "后期修图", "keywords": ["PS", "LR", "醒图", "剪映", "视频剪辑", "修图教程"]},
            {"name": "艺术设计", "keywords": ["插画", "平面设计", "字体设计", "艺术展", "手绘"]},
        ]
    },
    {
        "name": "情感心理",
        "keywords": ["情感", "心理", "治愈", "星座"],
        "children": [
            {"name": "恋爱婚姻", "keywords": ["脱单", "恋爱技巧", "婚礼备婚", "婚姻经营", "相亲"]},
            {"name": "心理咨询", "keywords": ["心理测试", "治愈", "焦虑", "原生家庭", "自我疗愈"]},
            {"name": "星座塔罗", "keywords": ["星座运势", "塔罗占卜", "命理", "水逆"]},
        ]
    },
]


async def init_industry_data(db: AsyncSession) -> None:
    """初始化行业数据"""
    # 检查是否已有数据
    result = await db.execute(select(Industry).limit(1))
    if result.scalar_one_or_none():
        return

    for main_industry_data in INITIAL_INDUSTRIES:
        # 创建主行业
        main_industry = Industry(
            name=main_industry_data["name"],
            keywords=main_industry_data["keywords"],
            parent_id=None
        )
        db.add(main_industry)
        await db.flush()  # 获取 ID

        # 创建子行业
        for sub_industry_data in main_industry_data["children"]:
            sub_industry = Industry(
                name=sub_industry_data["name"],
                keywords=sub_industry_data["keywords"],
                parent_id=main_industry.id
            )
            db.add(sub_industry)

    await db.commit()
